<!doctype html><html lang=en-us dir=ltr><head><meta charset=UTF-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="
  Auditing & Compliance
  #

Tongo provides flexible auditing mechanisms that enable compliance without sacrificing user privacy. Through viewing keys and ex-post proving, regulators can verify transaction details while preserving confidentiality for all other parties.

  Global Auditor
  #


  Concept
  #

The Tongo contract can designate a global auditor with public key $y_a$. All transfers are automatically encrypted for this auditor, providing a comprehensive audit trail without revealing amounts on-chain."><meta name=theme-color media="(prefers-color-scheme: light)" content="#ffffff"><meta name=theme-color media="(prefers-color-scheme: dark)" content="#343a40"><meta name=color-scheme content="light dark"><meta property="og:url" content="https://docs.tongo.cash/docs/auditor/"><meta property="og:site_name" content="Tongo Protocol"><meta property="og:title" content="Auditing & Compliance"><meta property="og:description" content="Auditing & Compliance # Tongo provides flexible auditing mechanisms that enable compliance without sacrificing user privacy. Through viewing keys and ex-post proving, regulators can verify transaction details while preserving confidentiality for all other parties.
Global Auditor # Concept # The Tongo contract can designate a global auditor with public key $y_a$. All transfers are automatically encrypted for this auditor, providing a comprehensive audit trail without revealing amounts on-chain."><meta property="og:locale" content="en_us"><meta property="og:type" content="article"><meta property="article:section" content="docs"><title>Auditing & Compliance | Tongo Protocol</title><link rel=icon href=/favicon.png><link rel=manifest href=/manifest.json><link rel=canonical href=https://docs.tongo.cash/docs/auditor/><link rel=stylesheet href=/book.min.a3621cc5553a2d3e6c1eef6158eab15d0c78037147ea50c2b0cc1400e7b455c5.css integrity="sha256-o2IcxVU6LT5sHu9hWOqxXQx4A3FH6lDCsMwUAOe0VcU=" crossorigin=anonymous><script defer src=/fuse.min.js></script><script defer src=/en.search.min.08e619da744a3a9339f34fb422eb78fd98793d12f9217328a022d56b5f38d299.js integrity="sha256-COYZ2nRKOpM580+0Iut4/Zh5PRL5IXMooCLVa1840pk=" crossorigin=anonymous></script><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/katex.min.css><script defer src=https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/katex.min.js></script><script defer src=https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/contrib/auto-render.min.js onload=renderMathInElement(document.body)></script><script>document.addEventListener("DOMContentLoaded",function(){renderMathInElement(document.body,{delimiters:[{left:"\\[",right:"\\]",display:!0},{left:"$$",right:"$$",display:!0},{left:"\\(",right:"\\)",display:!1},{left:"$",right:"$",display:!1}],throwOnError:!1})})</script></head><body dir=ltr><input type=checkbox class="hidden toggle" id=menu-control>
<input type=checkbox class="hidden toggle" id=toc-control><main class="container flex"><aside class=book-menu><div class=book-menu-content><nav><h2 class=book-brand><a class="flex align-center" href=/><span>Tongo Protocol</span></a></h2><div class="book-search hidden"><input type=text id=book-search-input placeholder=Search aria-label=Search maxlength=64 data-hotkeys=s/><div class="book-search-spinner hidden"></div><ul id=book-search-results></ul></div><script>document.querySelector(".book-search").classList.remove("hidden")</script><ul><li><a href=/docs/intro-to-tongo/>Introduction</a></li><li><a href=/docs/encryption/>Encryption System</a></li><li><a href=/docs/transfer/>Transfer Protocol</a></li><li><a href=/docs/auditor/ class=active>Auditing & Compliance</a></li><li><a href=/docs/sdk/>SDK Documentation</a></li><li><a href=/docs/contracts/>Cairo Contracts</a></li><li><a href=/docs/she/>SHE Library</a></li></ul></nav><script>(function(){var e=document.querySelector("aside .book-menu-content");addEventListener("beforeunload",function(){localStorage.setItem("menu.scrollTop",e.scrollTop)}),e.scrollTop=localStorage.getItem("menu.scrollTop")})()</script></div></aside><div class=book-page><header class=book-header><div class="flex align-center justify-between"><label for=menu-control><img src=/svg/menu.svg class=book-icon alt=Menu></label><h3>Auditing & Compliance</h3><label for=toc-control><img src=/svg/toc.svg class=book-icon alt="Table of Contents"></label></div><aside class="hidden clearfix"><nav id=TableOfContents><ul><li><a href=#global-auditor>Global Auditor</a><ul><li><a href=#concept>Concept</a></li><li><a href=#auditor-encryption>Auditor Encryption</a></li><li><a href=#multi-signature-auditing>Multi-Signature Auditing</a></li></ul></li><li><a href=#viewing-keys>Viewing Keys</a><ul><li><a href=#selective-disclosure>Selective Disclosure</a></li><li><a href=#use-cases>Use Cases</a></li><li><a href=#privacy-preserving-architecture>Privacy-Preserving Architecture</a></li></ul></li><li><a href=#ex-post-proving>Ex-Post Proving</a><ul><li><a href=#motivation>Motivation</a></li><li><a href=#protocol>Protocol</a></li><li><a href=#mathematical-foundation>Mathematical Foundation</a></li><li><a href=#off-chain-verification>Off-Chain Verification</a></li></ul></li><li><a href=#regulatory-compliance>Regulatory Compliance</a><ul><li><a href=#amlkyc-integration>AML/KYC Integration</a></li></ul></li><li><a href=#advanced-features>Advanced Features</a><ul><li><a href=#threshold-auditing>Threshold Auditing</a></li><li><a href=#zero-knowledge-compliance>Zero-Knowledge Compliance</a></li></ul></li></ul></nav></aside></header><article class="markdown book-article"><h1 id=auditing--compliance>Auditing & Compliance
<a class=anchor href=#auditing--compliance>#</a></h1><p>Tongo provides flexible auditing mechanisms that enable compliance without sacrificing user privacy. Through viewing keys and ex-post proving, regulators can verify transaction details while preserving confidentiality for all other parties.</p><h2 id=global-auditor>Global Auditor
<a class=anchor href=#global-auditor>#</a></h2><h3 id=concept>Concept
<a class=anchor href=#concept>#</a></h3><p>The Tongo contract can designate a <strong>global auditor</strong> with public key $y_a$. All transfers are automatically encrypted for this auditor, providing a comprehensive audit trail without revealing amounts on-chain.</p><h3 id=auditor-encryption>Auditor Encryption
<a class=anchor href=#auditor-encryption>#</a></h3><p>For every transfer of amount $b$, the sender creates three encryptions:</p><ul><li><strong>Sender</strong>: $(L_s, R) = \text{Enc}[y_s](b, r)$ - subtracted from balance</li><li><strong>Receiver</strong>: $(L_r, R) = \text{Enc}[y_r](b, r)$ - added to pending</li><li><strong>Auditor</strong>: $(L_a, R) = \text{Enc}[y_a](b, r)$ - stored for audit</li></ul><p>All three use the same blinding factor $r$, proven via Pedersen commitment proofs.</p><h3 id=multi-signature-auditing>Multi-Signature Auditing
<a class=anchor href=#multi-signature-auditing>#</a></h3><p>For enhanced security, auditor keys can be distributed across multiple parties:</p>$$y_a = g^{a_1 + a_2} = g^{a_1} \cdot g^{a_2} = y_{a_1} \cdot y_{a_2}$$<p>Individual auditors can compute partial decryptions:</p><ul><li>Auditor 1: $R^{a_1} = (g^r)^{a_1}$</li><li>Auditor 2: $R^{a_2} = (g^r)^{a_2}$</li></ul><p>The balance is recovered by combining: $g^b = L_a / (R^{a_1} \cdot R^{a_2})$</p><p>This prevents any single auditor from unilaterally accessing transaction data.</p><hr><h2 id=viewing-keys>Viewing Keys
<a class=anchor href=#viewing-keys>#</a></h2><h3 id=selective-disclosure>Selective Disclosure
<a class=anchor href=#selective-disclosure>#</a></h3><p>Users can optionally encrypt transfers for additional viewing keys beyond the global auditor:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-rust data-lang=rust><span style=display:flex><span><span style=color:#66d9ef>struct</span> <span style=color:#a6e22e>Transfer</span> {
</span></span><span style=display:flex><span>    <span style=color:#75715e>// ... other fields ...
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    L_opt: Option<span style=color:#f92672>&lt;</span>Array<span style=color:#f92672>&lt;</span>(PubKey, StarkPoint)<span style=color:#f92672>&gt;&gt;</span>, <span style=color:#75715e>// Additional viewing keys
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>}
</span></span></code></pre></div><p>Each viewing key $(y_v, L_v)$ represents:</p>$$L_v = g^b y_v^r$$<p>The sender proves each additional encryption is correctly formed using Pedersen commitment proofs.</p><h3 id=use-cases>Use Cases
<a class=anchor href=#use-cases>#</a></h3><ul><li><strong>Compliance officers</strong>: Institutional oversight</li><li><strong>Tax authorities</strong>: Jurisdiction-specific reporting</li><li><strong>Internal auditing</strong>: Corporate governance</li></ul><h3 id=privacy-preserving-architecture>Privacy-Preserving Architecture
<a class=anchor href=#privacy-preserving-architecture>#</a></h3><p>Viewing keys maintain privacy by:</p><ul><li>Only revealing amounts to authorized parties</li><li>Not exposing transaction values on-chain</li><li>Allowing granular access control per transaction</li></ul><hr><h2 id=ex-post-proving>Ex-Post Proving
<a class=anchor href=#ex-post-proving>#</a></h2><h3 id=motivation>Motivation
<a class=anchor href=#motivation>#</a></h3><p>After a transfer is completed, participants may need to prove a specific transaction detail to a third partie without revealing their private keys. Ex-post proving enables this through cryptographic proofs.</p><h3 id=protocol>Protocol
<a class=anchor href=#protocol>#</a></h3><p>Consider a completed transfer with ciphertext $(TL, TR) = (g^{b_0} y^{r_0}, g^{r_0})$. To prove the transfer amount to a third party with public key $\bar{y}$:</p><h4 id=1-revelation-phase>1. Revelation Phase
<a class=anchor href=#1-revelation-phase>#</a></h4><p>The sender creates new encryptions of the same amount:</p><ul><li><strong>Sender encryption</strong>: $(L, R) = \text{Enc}[y](b, r)$</li><li><strong>Third-party encryption</strong>: $(\bar{L}, R) = \text{Enc}[\bar{y}](b, r)$</li></ul><h4 id=2-consistency-proof>2. Consistency Proof
<a class=anchor href=#2-consistency-proof>#</a></h4><p>The sender proves the new encryptions contain the same amount as the original transfer:</p>$$\frac{TL}{L} = \left(\frac{TR}{R}\right)^x$$<p>This equality holds if and only if $b_0 = b$ (the amounts match).</p><h4 id=3-required-proofs>3. Required Proofs
<a class=anchor href=#3-required-proofs>#</a></h4><p>The complete ex-post proof $\pi_{\text{expost}}$ demonstrates:</p><ol><li><strong>Ownership</strong>: Knowledge of $x$ such that $y = g^x$ (POE)</li><li><strong>Blinding</strong>: Knowledge of $r$ such that $R = g^r$ (POE)</li><li><strong>Sender encryption</strong>: $L = g^b y^r$ (PED)</li><li><strong>Third-party encryption</strong>: $\bar{L} = g^b \bar{y}^r$ (PED)</li><li><strong>Consistency</strong>: $TL/L = (TR/R)^x$ (POE)</li></ol><h3 id=mathematical-foundation>Mathematical Foundation
<a class=anchor href=#mathematical-foundation>#</a></h3><p>The consistency check works because:</p>$$\frac{TL}{L} = \frac{g^{b_0} y^{r_0}}{g^b y^r} = g^{b_0-b} y^{r_0-r}$$$$\left(\frac{TR}{R}\right)^x = \left(\frac{g^{r_0}}{g^r}\right)^x = g^{(r_0-r)x} = y^{r_0-r}$$<p>These are equal only when $b_0 = b$, proving amount consistency.</p><h3 id=off-chain-verification>Off-Chain Verification
<a class=anchor href=#off-chain-verification>#</a></h3><p>Ex-post proofs require no on-chain interaction:</p><ul><li>Transaction data is retrieved from chain state</li><li>Proofs are generated and verified off-chain</li><li>Only requires the original transaction hash as reference</li></ul><hr><h2 id=regulatory-compliance>Regulatory Compliance
<a class=anchor href=#regulatory-compliance>#</a></h2><h3 id=amlkyc-integration>AML/KYC Integration
<a class=anchor href=#amlkyc-integration>#</a></h3><p>Tongo supports various compliance frameworks:</p><h4 id=real-time-monitoring>Real-Time Monitoring
<a class=anchor href=#real-time-monitoring>#</a></h4><ul><li>Global auditor receives all transaction encryptions</li><li>Automated threshold detection (encrypted amounts)</li><li>Pattern analysis on transaction graphs</li></ul><h4 id=selective-disclosure-1>Selective Disclosure
<a class=anchor href=#selective-disclosure-1>#</a></h4><ul><li>Users can voluntarily encrypt for compliance officers</li><li>Jurisdiction-specific reporting requirements</li><li>Time-limited viewing key access</li></ul><h4 id=retroactive-investigation>Retroactive Investigation
<a class=anchor href=#retroactive-investigation>#</a></h4><ul><li>Ex-post proving enables transaction reconstruction</li><li>User cooperation required for private key revelation</li><li>Court-ordered disclosure mechanisms</li></ul><hr><h2 id=advanced-features>Advanced Features
<a class=anchor href=#advanced-features>#</a></h2><h3 id=threshold-auditing>Threshold Auditing
<a class=anchor href=#threshold-auditing>#</a></h3><p>Multiple auditors with threshold decryption:</p>$$y_a = \sum_{i=1}^n w_i \cdot y_{a_i}$$<p>Where $w_i$ are threshold weights and $t$ out of $n$ auditors are required for decryption.</p><h3 id=zero-knowledge-compliance>Zero-Knowledge Compliance
<a class=anchor href=#zero-knowledge-compliance>#</a></h3><p>Prove compliance properties without revealing amounts:</p><ul><li><strong>Range compliance</strong>: Prove transfer amount below threshold</li><li><strong>Velocity limits</strong>: Prove cumulative amounts within bounds</li><li><strong>Whitelist compliance</strong>: Prove recipient authorization</li></ul><p>These advanced features demonstrate Tongo&rsquo;s flexibility in balancing privacy and regulatory requirements across diverse jurisdictions and use cases.</p></article><footer class=book-footer><div class="flex flex-wrap justify-between"><div><a class="flex align-center" href=https://github.com/fatlabsxyz/tongo-docs/edit/master/packages/tongo-docs/content/docs/auditor.md target=_blank rel=noopener><img src=/svg/edit.svg class=book-icon alt>
<span>Edit this page</span></a></div></div><script>(function(){function e(e){const t=window.getSelection(),n=document.createRange();n.selectNodeContents(e),t.removeAllRanges(),t.addRange(n)}document.querySelectorAll("pre code").forEach(t=>{t.addEventListener("click",function(){if(window.getSelection().toString())return;e(t.parentElement),navigator.clipboard&&navigator.clipboard.writeText(t.parentElement.textContent)})})})()</script></footer><div class=book-comments></div><label for=menu-control class="hidden book-menu-overlay"></label></div><aside class=book-toc><div class=book-toc-content><nav id=TableOfContents><ul><li><a href=#global-auditor>Global Auditor</a><ul><li><a href=#concept>Concept</a></li><li><a href=#auditor-encryption>Auditor Encryption</a></li><li><a href=#multi-signature-auditing>Multi-Signature Auditing</a></li></ul></li><li><a href=#viewing-keys>Viewing Keys</a><ul><li><a href=#selective-disclosure>Selective Disclosure</a></li><li><a href=#use-cases>Use Cases</a></li><li><a href=#privacy-preserving-architecture>Privacy-Preserving Architecture</a></li></ul></li><li><a href=#ex-post-proving>Ex-Post Proving</a><ul><li><a href=#motivation>Motivation</a></li><li><a href=#protocol>Protocol</a></li><li><a href=#mathematical-foundation>Mathematical Foundation</a></li><li><a href=#off-chain-verification>Off-Chain Verification</a></li></ul></li><li><a href=#regulatory-compliance>Regulatory Compliance</a><ul><li><a href=#amlkyc-integration>AML/KYC Integration</a></li></ul></li><li><a href=#advanced-features>Advanced Features</a><ul><li><a href=#threshold-auditing>Threshold Auditing</a></li><li><a href=#zero-knowledge-compliance>Zero-Knowledge Compliance</a></li></ul></li></ul></nav></div></aside></main></body></html>